# SecurityAgent 示例任务Prompts

以下是三个精心设计的任务prompt，展现SecurityAgent在实际安全分析场景下的高效能力：

## 1. CVE漏洞复现任务

```
复现CVE-2021-3156（Baron Samedit - Sudo堆缓冲区溢出漏洞）：

1. 分析NVD页面，重点关注标记为"Exploit"的链接
2. 提取关键信息：受影响的sudo版本、具体触发条件、环境要求
3. 配置漏洞环境：安装vulnerable sudo版本，设置必要的编译选项
4. 执行漏洞触发：使用提取的具体命令和参数触发漏洞
5. 验证复现结果：通过crash现象和调试工具确认成功
6. 可选：使用AFL++进一步发现类似漏洞
```

**核心能力展现**：
- **实际复现**：真正配置环境并触发漏洞，而非仅分析描述
- **Browser Tool智能使用**：高效提取exploit链接中的关键配置信息
- **环境精准配置**：根据exploit要求配置确切的漏洞环境
- **验证驱动**：通过实际crash验证复现成功
- **事件驱动fuzzing**：使用零轮询的AFL++进行进一步测试

## 2. 二进制安全审计任务

```
对目标程序 /usr/bin/target-app 进行全面安全审计：

1. 静态分析：检查程序架构、安全特性（NX、ASLR、Stack Canaries）
2. 识别攻击面：分析输入源、危险函数调用、潜在溢出点
3. 智能fuzzing：
   - 根据程序类型创建有效种子文件
   - 启动多核并行AFL++模糊测试
   - 事件驱动等待crash，无需手动检查
4. 崩溃分析：自动收集、分类和优先级排序所有崩溃
5. 深度验证：使用GDB分析可利用的崩溃，评估安全影响
6. 报告生成：提供可操作的修复建议和风险评级
```

**核心能力展现**：
- **高效静态分析**：快速识别程序安全特征和风险点
- **智能测试策略**：基于程序特征的针对性fuzzing设计
- **零轮询监控**：事件驱动的crash检测，无API开销
- **专业崩溃分析**：自动化的崩溃收集、分类和可利用性评估
- **实用报告输出**：面向开发者的具体修复指导

## 3. 网络服务安全测试任务

```
对运行在 localhost:8080 的网络服务进行安全测试：

1. 服务识别：快速识别服务类型、版本、运行协议
2. 漏洞扫描：检测常见网络服务漏洞（注入、认证绕过、缓冲区溢出）
3. 协议模糊测试：
   - 分析网络协议格式和交互模式
   - 生成格式感知的变异输入
   - 使用AFL++网络模式进行持续测试
4. 异常监控：实时检测服务崩溃、挂起、内存泄漏等异常
5. 影响评估：验证发现的漏洞，评估安全影响和可利用性
6. 修复指导：提供具体的代码修复建议和安全配置优化
```

**核心能力展现**：
- **网络协议分析**：快速理解服务协议和交互特征
- **协议感知fuzzing**：生成符合协议格式的有效测试输入
- **实时异常检测**：监控服务状态，及时发现安全问题
- **漏洞影响评估**：评估发现漏洞的实际安全风险
- **实用修复建议**：提供开发者可直接采用的安全改进方案

## 使用说明

这些任务设计充分体现了SecurityAgent的核心优势：

1. **实操为先**：专注于实际的安全测试操作，而非理论分析
2. **环境导向**：强调CVE复现中的精确环境配置和实际触发
3. **验证驱动**：通过具体的崩溃现象和调试验证确保测试有效性
4. **工具集成**：充分利用AFL++事件驱动、GDB分析等专业工具
5. **结果实用**：提供开发者可直接采用的修复建议和安全改进

### 执行示例

```bash
# 使用SecurityAgent执行任务
openhands --agent SecurityAgent --task "上述任务prompt内容"

# 或通过API
from openhands.agenthub.security_agent import SecurityAgent
agent = SecurityAgent(llm, config)
result = agent.run("上述任务prompt内容")
```

### 预期效果

使用这些任务prompt，您可以期待：

- **真实复现**：CVE漏洞能够在配置的环境中实际触发和验证
- **高效发现**：通过事件驱动fuzzing快速发现程序漏洞，无轮询开销
- **专业分析**：提供安全专家级别的漏洞分析和可利用性评估
- **实用输出**：生成开发团队可直接采用的修复建议和安全改进方案
- **成本优化**：简化的分析流程显著降低时间和资源消耗

这些示例任务展现了SecurityAgent在防御性安全分析中的专业实力和实用价值。
